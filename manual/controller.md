# `Controller`类使用说明

## 一、概述

`Controller`类位于`Sharky\Core`命名空间下，是框架中的控制器模块，主要负责处理与业务逻辑相关的操作，如获取配置信息以及在出现错误时渲染相应的错误页面等。

## 二、类的初始化

`Controller`类在`Route`请求到达时，框架自动完成创建和初始化操作。

## 三、主要方法说明

### 1. `renderErrorPage($error)`方法

- **功能**：此方法用于渲染错误页面。当应用程序出现错误时，可以调用该方法来向用户展示相应的错误信息和页面。
- **参数说明**：
  - `$error`：一个包含错误相关信息的数组或者对象（虽然示例中按数组形式处理，但也可根据实际情况为对象等其他形式），其中至少应包含错误代码（通过`$error['code']`获取，若不存在则默认为500）和错误消息（通过`$error['message']`获取，若不存在则默认为`Internal Server Error`）等关键信息。
- **操作流程**：
  - 首先，将传入的`$error`参数赋值给类的`$error`属性，以便在后续可能的其他操作中可以访问到该错误信息。
  - 接着，从`$error`参数中获取错误代码，如果不存在则默认为500，并通过`http_response_code($code)`设置HTTP响应状态码为对应的错误代码值。
  - 然后，确定错误模板文件的路径。通过拼接`SHARKY_ROOT`（假设这是一个已定义的常量，表示框架的根目录）和`'/errors/'`来得到错误模板所在目录的路径，再根据错误代码拼接出具体的错误文件路径（如`"{$code}.php"`）。
  - 最后，如果该错误文件存在（通过`file_exists($errorFile)`判断），则使用`include $errorFile`将错误文件包含进来，从而渲染出对应的错误页面；如果文件不存在，则直接输出包含错误代码和错误消息的字符串（如`"{$code} Error - {$message}"`）。

## 四、使用步骤

### 1. 创建`Controller`类的实例

```php
$controller = new Controller();
```

### 2. 当应用程序出现错误并需要渲染错误页面时，准备好包含错误信息（至少有错误代码和错误消息）的数组或对象，然后调用`renderErrorPage`方法

```php
$errorInfo = [
    'code' => 404,
    'message' => 'Page Not Found'
];
$controller->renderErrorPage($errorInfo);
```

---

本文档是在 AI 生成的内容的基础上修订，其信息不保证完全准确。

在使用过程中，如果您发现了任何问题或者有疑问，可以通过 new issues 的方式反馈，我们会及时处理。感谢您的理解与支持。

修订：2024-11-6 22点
